<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      移动端click300-380ms延迟问题 | 高大秀博客 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="高大秀">
    
    

    <meta name="description" content="移动设备上的web网页是有300ms延迟的，玩玩会造成按钮点击延迟甚至是点击失效。历史原因 来源一个公司内一个同事的分享:2007年苹果发布首款iphone上iOS系统搭载的safari为了将适用于PC端上大屏幕的网页能比较好的展示在手机端上，使用了双击缩放(double tap to zoom)的方案，比如你在手机上用浏览器打开一个PC上的网页，你可能在看到页面内容虽然可以撑满整个屏幕，但是字体">
<meta name="keywords" content="移动端">
<meta property="og:type" content="article">
<meta property="og:title" content="移动端click300-380ms延迟问题 | 高大秀博客">
<meta property="og:url" content="http://yoursite.com/2017/07/28/移动端click300-380ms延迟问题/index.html">
<meta property="og:site_name" content="高大秀博客">
<meta property="og:description" content="移动设备上的web网页是有300ms延迟的，玩玩会造成按钮点击延迟甚至是点击失效。历史原因 来源一个公司内一个同事的分享:2007年苹果发布首款iphone上iOS系统搭载的safari为了将适用于PC端上大屏幕的网页能比较好的展示在手机端上，使用了双击缩放(double tap to zoom)的方案，比如你在手机上用浏览器打开一个PC上的网页，你可能在看到页面内容虽然可以撑满整个屏幕，但是字体">
<meta property="og:updated_time" content="2017-08-16T15:29:30.997Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="移动端click300-380ms延迟问题 | 高大秀博客">
<meta name="twitter:description" content="移动设备上的web网页是有300ms延迟的，玩玩会造成按钮点击延迟甚至是点击失效。历史原因 来源一个公司内一个同事的分享:2007年苹果发布首款iphone上iOS系统搭载的safari为了将适用于PC端上大屏幕的网页能比较好的展示在手机端上，使用了双击缩放(double tap to zoom)的方案，比如你在手机上用浏览器打开一个PC上的网页，你可能在看到页面内容虽然可以撑满整个屏幕，但是字体">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.jpg">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">高大秀博客</a></h1>
        <hr class="panel-cover__divider" />

        
        <div class="icon-avatar">
            <span class="icon">
                <div class="icon-avatar-bg"></div>
            </span>

        </div>

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">


              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">首页</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">关于</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">归档</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">移动端click300-380ms延迟问题</h1>

    

    <div class="post-meta">
      <time datetime="2017-07-28" class="post-meta__date date">2017-07-28</time>
      <span class="post-meta__tags tags">

          

          
             &#8226; 标签:
            <font class="tags">
              <a class="tags-link" href="/tags/移动端/">移动端</a>
            </font>
          

      </span>
      <span id="busuanzi_container_page_pv">
  本文总阅读量<span id="busuanzi_value_page_pv"></span>次
</span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <h1 id="移动设备上的web网页是有300ms延迟的，玩玩会造成按钮点击延迟甚至是点击失效。"><a href="#移动设备上的web网页是有300ms延迟的，玩玩会造成按钮点击延迟甚至是点击失效。" class="headerlink" title="移动设备上的web网页是有300ms延迟的，玩玩会造成按钮点击延迟甚至是点击失效。"></a>移动设备上的web网页是有300ms延迟的，玩玩会造成按钮点击延迟甚至是点击失效。</h1><h2 id="历史原因"><a href="#历史原因" class="headerlink" title="历史原因"></a>历史原因</h2><ul>
<li>来源一个公司内一个同事的分享:2007年苹果发布首款iphone上iOS系统搭载的safari为了将适用于PC端上大屏幕的网页能比较好的展示在手机端上，使用了双击缩放(double tap to zoom)的方案，比如你在手机上用浏览器打开一个PC上的网页，你可能在看到页面内容虽然可以撑满整个屏幕，但是字体、图片都很小看不清，此时可以快速双击屏幕上的某一部分，你就能看清该部分放大后的内容，再次双击后能回到原始状态。 双击缩放是指用手指在屏幕上快速点击两次，ios 自带的 Safari 浏览器会将网页缩放至原始比例。 原因就出在浏览器需要如何判断快速点击上，当用户在屏幕上单击某一个元素时候，例如跳转链接，此处浏览器会先捕获该次单击，但浏览器不能决定用户是单纯要点击链接还是要双击该部分区域进行缩放操作，所以，捕获第一次单击后，浏览器会先Hold一段时间t，如果在t时间区间里用户未进行下一次点击，则浏览器会做单击跳转链接的处理，如果t时间里用户进行了第二次单击操作，则浏览器会禁止跳转，转而进行对该部分区域页面的缩放操作。那么这个时间区间t有多少呢？在IOS safari下，大概为300毫秒。这就是延迟的由来。造成的后果用户纯粹单击页面，页面需要过一段时间才响应，给用户慢体验感觉，对于web开发者来说是，页面js捕获click事件的回调函数处理，需要300ms后才生效，也就间接导致影响其他业务逻辑的处理。<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2></li>
</ul>
<h3 id="1-tap-js解决方案"><a href="#1-tap-js解决方案" class="headerlink" title="1.tap.js解决方案"></a>1.tap.js解决方案</h3><ul>
<li>使用 zepto.js 的 tap 事件，通过 singleTap 和 doubleTap 来区分单击和双击。但是会出现点击穿透，而且对于已经使用 click 的文件，改动成本太大。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;tap.js&quot;&gt;&lt;/script&gt;</div><div class="line"></div><div class="line">&lt;div id=&quot;container&quot;&gt;</div><div class="line">  &lt;button id=&quot;button-1&quot;&gt;Click event&lt;/button&gt;</div><div class="line">  &lt;button id=&quot;button-2&quot;&gt;Tap event&lt;/button&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;div id=&quot;output&quot;&gt;&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">  var container = document.getElementById(&apos;container&apos;)</div><div class="line">  var button1 = document.getElementById(&apos;button-1&apos;);</div><div class="line">  var button2 = document.getElementById(&apos;button-2&apos;);</div><div class="line">  var output = document.getElementById(&apos;output&apos;);</div><div class="line"></div><div class="line">  var tap = new Tap(container);</div><div class="line"></div><div class="line">  button1.addEventListener(&apos;click&apos;, callback, false);</div><div class="line">  button2.addEventListener(&apos;tap&apos;, callback, false);</div><div class="line"></div><div class="line">  function callback (e) &#123;</div><div class="line">      e.preventDefault();</div><div class="line">      var p = document.createElement(&apos;p&apos;);</div><div class="line">      p.textContent = &apos;event: &apos; + e.type;</div><div class="line">      output.insertBefore(p, output.firstChild);</div><div class="line">  &#125;</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-对于高版本chrome和firefox，可以通过禁用伸缩，即在-head-上的-meta-标签添加-user-scalable-no。如下："><a href="#2-对于高版本chrome和firefox，可以通过禁用伸缩，即在-head-上的-meta-标签添加-user-scalable-no。如下：" class="headerlink" title="2.对于高版本chrome和firefox，可以通过禁用伸缩，即在 head 上的 meta 标签添加 user-scalable = no。如下："></a>2.对于高版本chrome和firefox，可以通过禁用伸缩，即在 head 上的 meta 标签添加 user-scalable = no。如下：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, user-scalable=no&quot;&gt;</div></pre></td></tr></table></figure>
<h3 id="3-chrome32-可以将-viewport-的宽度设置成-device-width"><a href="#3-chrome32-可以将-viewport-的宽度设置成-device-width" class="headerlink" title="3.chrome32+ 可以将 viewport 的宽度设置成 device-width."></a>3.chrome32+ 可以将 viewport 的宽度设置成 device-width.</h3><h3 id="4-IE10-，可以使用-pointerEvents。可以让特定的元素或者整个文档中的元素移除点击延迟的问题，同时不会影响-pinch-zooming"><a href="#4-IE10-，可以使用-pointerEvents。可以让特定的元素或者整个文档中的元素移除点击延迟的问题，同时不会影响-pinch-zooming" class="headerlink" title="4.IE10+，可以使用 pointerEvents。可以让特定的元素或者整个文档中的元素移除点击延迟的问题，同时不会影响 pinch-zooming"></a>4.IE10+，可以使用 pointerEvents。可以让特定的元素或者整个文档中的元素移除点击延迟的问题，同时不会影响 pinch-zooming</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a, button, .myelements</div><div class="line">&#123;</div><div class="line">-ms-touch-action: manipulation;    /* IE10  */</div><div class="line">touch-action: manipulation;        /* IE11+ */</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="5-通过-touchend-事件代替-click-事件。"><a href="#5-通过-touchend-事件代替-click-事件。" class="headerlink" title="5.通过 touchend 事件代替 click 事件。"></a>5.通过 touchend 事件代替 click 事件。</h3><h3 id="6-fastclick-js解决方法"><a href="#6-fastclick-js解决方法" class="headerlink" title="6.fastclick.js解决方法"></a>6.fastclick.js解决方法</h3><ul>
<li>终极大 boss。 fastclick。上面的几种方法都是针对某些浏览器，或者某些浏览器的某些版本，或者会影响到我们平常使用方式的解决方案。使用起来不方便且考虑的细节很多，实践难度比较大。fastclick 作为一个终极的解决方案，使用方便，文件大小压缩后只有 3.3k。对于交互相对复杂的移动端web页面或应用是一个相对不错的解决方案。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;title&gt;&lt;/title&gt;</div><div class="line">    &lt;style&gt;</div><div class="line">        *</div><div class="line">        &#123;</div><div class="line">            margin: 0;</div><div class="line">        &#125;</div><div class="line">        body</div><div class="line">        &#123;</div><div class="line">        &#125;</div><div class="line">        .button</div><div class="line">        &#123;</div><div class="line">            background-color: #3d3d3d;</div><div class="line">            border: 0px;</div><div class="line">            height: 80px;</div><div class="line">            width: 80%;</div><div class="line">            font-size: 50px;</div><div class="line">            margin: 10% 0% 0% 10%;</div><div class="line">            color: #fff;</div><div class="line">        &#125;</div><div class="line">        .fu</div><div class="line">        &#123;</div><div class="line">            min-height: 100%;</div><div class="line">            min-width: 100%;</div><div class="line">            background-color: Black;</div><div class="line">            background: rgba(0,0,0,0.4);</div><div class="line">            position: absolute;</div><div class="line">            top: 0;</div><div class="line">            text-align: center;</div><div class="line">            display: none;</div><div class="line">        &#125;</div><div class="line">        .ts</div><div class="line">        &#123;</div><div class="line">            margin: 8% auto;</div><div class="line">            width: 400px;</div><div class="line">            height: 400px;</div><div class="line">            top: 59%;</div><div class="line">            background-color: #fff;</div><div class="line">            text-align: center;</div><div class="line">        &#125;</div><div class="line">    &lt;/style&gt;</div><div class="line">    &lt;script src=&quot;fastclick.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;jquery-1.7.2.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</div><div class="line">    //javascript:</div><div class="line">    &lt;script type=&quot;application/javascript&quot;&gt;</div><div class="line">        window.addEventListener(&apos;load&apos;, function () &#123;</div><div class="line">            FastClick.attach(document.body);</div><div class="line">        &#125;, false);</div><div class="line">        function xian() &#123;</div><div class="line">            $(&quot;.fu&quot;).show().hide(350);</div><div class="line">        &#125;</div><div class="line">    &lt;/script&gt;</div><div class="line">    //jQuery:</div><div class="line">    &lt;script&gt;</div><div class="line">        window.addEventListener(&apos;load&apos;, function () &#123;</div><div class="line">$(function() &#123;</div><div class="line">        FastClick.attach(document.body);</div><div class="line">    &#125;);</div><div class="line">    &lt;/script&gt;</div><div class="line">    //CommonJS:</div><div class="line">attachFastClick = require(&apos;fastclick&apos;);</div><div class="line">    attachFastClick(document.body);</div><div class="line">    AMD:</div><div class="line">    var FastClick = require(&apos;fastclick&apos;);</div><div class="line">    FastClick.attach(document.body, options);</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;div&gt;</div><div class="line">        &lt;div class=&quot;but&quot;&gt;</div><div class="line">            &lt;input class=&quot;button&quot; type=&quot;button&quot; value=&quot;点击我&quot; onclick=&quot;xian()&quot; /&gt;&lt;/div&gt;</div><div class="line">        &lt;div class=&quot;fu&quot; &gt;</div><div class="line">            &lt;div class=&quot;ts&quot;&gt;</div><div class="line">                我是浮层</div><div class="line">            &lt;/div&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></li>
</ul>

  </section>

  <section class="post-comments youyan" id="comments">
    <!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2142142"></script>
<!-- UY END -->


    <!-- <div class="icon-shangyin">
        赏
        <div class="text">
            <span class="weixin">
                <i></i>
                <b>微信</b>
            </span>
            <span class="zhifubao">
                <i></i>
                <b>支付宝</b>
            </span>
            <b>感谢赏我一个棒棒糖哦~~</b>
            <i class="footer"></i>
        </div>

    </div> -->

    <!-- 将评论系统（例如Disqus、多说、友言、畅言等）提供的代码片段粘贴在这里 -->


</section>


</article>


            <footer class="footer">
<span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>
    <span class="footer__copyright">
        &copy; 作者 : 高大秀 |
        主题:<a href="https://github.com/someus/huno">Huno</a>
        <span>&nbsp;&nbsp;文章所有权归作者所有,如需引用,请标明出处。</span>
    </span>
    
</footer>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
